first_value() - оконная функция. Попробуй использовать ее в примере 105?
row_number - используется для избежания повторений (получения уникальных значений)

При выполнении Delete следует сначала выполнить сам запос (выполнить SELECT)

WHERE 1=1 -- быстро добавлять или убирать количество условий, вплоть до нуля условий (WHERE без параметров работать не может, а с 1=1 - может)

WHERE (FIRST_NAME, LAST_NAME) IN (SELECT c двумя полями) или можно (FIRST_NAME || LAST_NAME) ...

EXISTS/NOT EXISTS плохо (медленно) работает в Hive

SOME - хотя бы одно, из..
Хороший пример с ANY - LIKE ANY
WITH - хороший случай разбиения логики. То есть это не связано с оптимизацией. Запросы в секции WITH просто подставятся.


---- ВЕРСИОННОСТЬ по SCD 

type 0 - измерение никогда не меняется
type 1 - измерение меняется. История не хранится
type 2 - хранит всю историю изменений с помощью полей from_date to_date (массивая таблица)
type 3 - есть доп. поля, которые хранят предыдущие значения полей измерения. 
type 4 - в измерении хранятся только актуальные данные, изменения сохраняются в отдельную таблицу с историей.
